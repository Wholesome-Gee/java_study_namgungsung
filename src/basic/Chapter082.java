package basic; // 82. 참조변수의 형변환(2)

/**
* [핵심 요약]
	1. 컴파일 타임 vs 런타임 (00:12:15)
		- 컴파일러는 타입 간의 상속 관계만 확인하여 형변환 가능 여부를 판단합니다. [00:12:19]
		- 하지만 실행 시(런타임)에는 실제 가리키는 객체의 멤버 개수가 중요합니다. [00:08:21]
	2. 형변환의 한계 (00:08:33)
		- 실제 인스턴스가 가진 멤버 개수보다 더 많은 기능을 가진 리모컨으로 형변환하는 것은 불가능합니다. [00:12:58]
	3. 주의해야 할 예외 (00:10:30)
		- ClassCastException: 형변환은 성공했으나 실제 객체에 해당 기능이 없을 때 발생합니다. [00:10:33]
		- NullPointerException: 참조변수가 null인 상태에서 메서드를 호출할 때 발생합니다. [00:04:23]
*/

class Car {
  String color;
  int door;
  void drive() { System.out.println("drive, Brrr~"); }
  void stop() { System.out.println("stop!!!"); }
}

class FireEngine extends Car {
  void water() { System.out.println("water!!!"); }
}

public class Chapter082 {
  public static void main(String[] args) {
  	// Case 1: 객체가 없는 경우 (00:04:12)
  	Car c1 = null;
  	FireEngine fe1 = (FireEngine)c1; // 형변환은 OK (상속관계니까) [00:04:03]
  	// fe1.water(); // 런타임 에러: NullPointerException 발생 [00:04:23]

  	// Case 2: 조상 인스턴스를 자손 타입으로 형변환하는 경우 (00:09:52)
  	Car c2 = new Car(); // 실제 객체는 Car (멤버 4개) [00:11:18]
  	// FireEngine fe2 = (FireEngine)c2; // 컴파일은 OK, 실행 시 ClassCastException!! [00:10:33]
  	// 왜? fe2 리모컨은 버튼이 5개인데, 실제 제품(c2)은 기능이 4개뿐이라서. [00:12:00]

  	// Case 3: 안전한 형변환 (00:05:31)
  	Car c3 = new FireEngine(); // 실제 객체는 FireEngine (멤버 5개) [00:05:43]
  	FireEngine fe3 = (FireEngine)c3; // OK! 실제 객체에 5개 기능이 다 있음. [00:08:34]
  	fe3.water(); // 정상 작동
  }
}

/**
 * [Gemini의 꼼꼼한 보충수업]
	1. 리모컨과 제품의 관계 (00:07:02)
		- 리모컨(참조변수)의 버튼을 늘릴 때는(다운캐스팅), 실제 제품(인스턴스)이 그 버튼에 해당하는 기능을 가지고 있는지 꼭 확인해야 합니다. [00:08:50]
	2. 컴파일러의 한계 (00:12:15)
		- 컴파일러는 "둘이 부모 자식 사이야? 그럼 형변환 써줬으니까 일단 통과!"라고만 생각합니다. 실제 객체가 무엇인지는 실행해 봐야 알 수 있습니다. [00:12:28]
	3. 에러 방지 전략 (00:13:41)
		- 형변환을 하기 전에 항상 이 리모컨이 가리키는 실제 객체가 내가 바꾸려는 타입이 맞는지 확인하는 습관이 필요합니다. [00:13:53]
 */

/**
* [실무 꿀팁 - 런타임 에러 예방]
	1. 인스턴스 확인 (00:05:19)
		- 형변환을 시도할 때는 반드시 `instanceof` 연산자(다음 강의 주제)를 사용하여 실제 객체 타입을 확인하는 것이 안전합니다. [00:13:53]
	2. 조상 객체 생성 자제
		- `Car c = new Car();` 처럼 조상 타입의 객체를 직접 생성해서 자손으로 형변환하는 경우는 실무에서 거의 없으며, 대부분 에러로 이어집니다. [00:13:29]
	3. 디버깅 포인트
		- `ClassCastException`이 발생했다면, "리모컨 버튼이 실제 제품 기능보다 많구나!"라고 즉시 판단하고 객체 생성 부분을 확인하세요. [00:10:33]
*/